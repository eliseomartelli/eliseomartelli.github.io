---
title: Nebula, a simple overlay networking tool
categories: networking
---

VPNs are one of the preferred ways to tie-up multiple servers (and clients) together, but their nature becomes a **bottleneck** when the infrastructure to *link* becomes larger.  
A solution to this problem comes in the form of a software defined network **(SDN)**.

[**Nebula**](https://github.com/slackhq/nebula) (from SlackHQ) addresses this problem by providing software that helps you build a point-to-point network between devices that can be situated (almost) anywhere in the world!

The communication between devices is encrypted using the [Noise Protocol Framework](https://noiseprotocol.org/), the same used by Signal.

And you know what's great? Nebula is completely **open source!**

## Nebula Vocabolary

Nebula's vocabolary is not so different from normal networking, you should only get accostumed to two terms:
- lighthouse;
- node.

**Lighthouse** is the term used by Nebula to address **nodes** that are publicly routable.  
A node connects first to the **lighthouse**, then it discovers the most efficent path to reach other nodes on the network.

## Configuring Nebula

Let's get to the fun part!

As stated earlier, to run a Nebula Lighthouse you need a machine with a publicly routable IP address, if you don't have one, a little 5$ Droplet on [DigitalOcean](https://m.do.co/c/33e2f0a1e231) will do just fine.

1. Download and extract Nebula from its GitHub repo:  
```
$ curl -OL https://github.com/slackhq/nebula/releases/download/v1.2.0/nebula-linux-amd64.tar.gz
$ tar xzvf nebula-linux-amd64.tar.gz
```
2. Install Nebula on your hosts:
```
# install ./nebula /usr/bin
```
3. Create a "nebula" user:
```
#Â useradd --system --no-create-home nebula
```
4. Generate a Nebula certificate authority:
```
./nebula-cert ca -name "My really cool organization"
```
5. Generate certificates 
./nebula-cert sign -name "lighthouse1" -ip "192.168.100.1/24"

6. 
setcap cap_net_admin=+pe /usr/bin/nebula

7. Optional Systemd

[Unit]
Description=Nebula Service
After=network.target
StartLimitIntervalSec=0

[Service]
Type=simple
Restart=always
RestartSec=1
User=nebula
ExecStart=/usr/bin/nebula -config /etc/nebula/config.yml

[Install]
WantedBy=multi-user.target


generate ca
generate key for node(s)
copy ca to our lighthouse
copy keys to other nodes
config.yml

# Testing Nebula

Tests here m8